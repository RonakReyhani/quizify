Le présent document a été archivé. Pour le dernier contenu technique à ce sujet, voir la page Livres blancs et guides d'AWS. Amazon Web Services – Base de données sur les migrations d'AWS Les meilleures pratiques sont fournies à des fins d'information seulement. Ce document représente les offres et les pratiques de produits d'AWS en vigueur à la date de publication de ce document. Les clients sont responsables de faire leur propre évaluation indépendante des informations contenues dans ce document et de toute utilisation des produits ou services d'AWS. Ce document ne crée pas de garanties, de représentations, d'engagements contractuels, de conditions ou d'assurances de la part d'AWS. Les responsabilités et les responsabilités d'AWS envers ses clients sont contrôlées par des accords AWS. Ce document ne fait pas partie, ni ne modifie, d'un accord entre AWS et ses clients. Ce guide explique comment migrer les charges de travail de DMS vers VPC. Le service de migration de base de données AWS vous permet de migrer les données d'une base de données source vers une base de données cible. La plupart des méthodes actuelles de migration des bases de données vers le cloud ou les moteurs de commutation nécessitent une panne prolongée. Ce document décrit les meilleures pratiques pour utiliser AWS DMS. Au cours d'une migration, le service suit les modifications apportées à la base de données source afin qu'elles puissent être appliquées à la base de données cible. ions sont : Migrations homogènes (migrations entre les mêmes types de moteurs) À un niveau élevé, lorsque l'on utilise AWS DMS, un utilisateur fournit un serveur de réplication et définit les paramètres source et cible. Une tâche typique consiste en trois phases principales : la pleine charge, l'application des changements mis en cache et la réplication continue. Les données sont chargées de la base de données source aux tables de la base de données cible, huit tables à la fois. le serveur de réplication. La capture des modifications pour une table donnée ne commence pas jusqu'à ce que la charge complète pour cette table commence. Lorsque TOUTES les tables sont chargées, vous commencez à collecter des modifications comme transactions pour la phase de réplication continue. Après toutes les modifications mises en cache sont appliquées, vos tables sont cohérentes transactionnellement et vous passez à la phase de réplication continue, en appliquant des modifications comme transactions. Il y aura un arriéré de transactions causant un certain décalage entre la base de données source et cible. AWS DMS va créer les objets de schéma cible qui sont nécessaires pour effectuer la migration. AWS DMS adopte une approche minimaliste et crée uniquement les objets nécessaires pour migrer efficacement les données. En d'autres termes, il va créer des tables, des clés primaires et, dans certains cas, des index uniques. Dans la plupart des cas, lors d'une migration, vous voudrez également migrer la plupart ou la totalité du schéma source. Si vous effectuez une migration homogène, utilisez votre native tools pour effectuer une exportation/importation de données sans le schema sud-est. Toute dépendance intertable, telle que les contraintes de clé étrangères, doit être désactivée pendant les phases de changement de charge complète et de l'application de changement d'échelle AWS DMS. Si votre migration est hétérogène, vous pouvez utiliser l'outil de conversion AWS Schema (AWS SCT) pour générer un schéma cible complet pour vous. AWS DMS est un service géré qui fonctionne sur un cloud de calcul élastique Amazon (Amazon EC2) Le service se connecte aux données source Certaines des classes d'instances plus petites sont suffisantes pour tester le service ou pour de petites migrations. Les transactions importantes peuvent nécessiter un certain tampon sur le disque. Les transactions et les fichiers journaux sont également écrits sur le disque. Les instances de type Note T2 sont conçues pour fournir des performances de base modérées. Si votre migration implique un grand nombre de tables, ou si vous avez l'intention d'exécuter plusieurs tâches de réplication simultanée, vous devez Les instances T2 sont bien adaptées aux charges de travail générales, telles que les serveurs web, les environnements développeurs et les petites bases de données. Elles sont destinées aux charges de travail qui n'utilisent pas le processeur complet souvent ou régulièrement, mais qui ont parfois besoin d'éclater. Selon la classe d'instance, votre serveur de réplication sera livré avec 50 Go ou 100 Go de stockage de données. Ce stockage est utilisé pour les fichiers journaux et les modifications mises en cache qui sont collectées. Si votre système source est occupé ou prend des transactions importantes, vous pourriez avoir besoin d'augmenter cette quantité de stockage. Tous les volumes de stockage dans AWS DMS sont GP2 ou SSD à usage général. Les volumes GP2 viennent avec une performance de base de trois opérations d'E/S par seconde (IOPS), avec des capacités à éclater jusqu'à 3000 IOPS sur une base de crédit. Choisir une instance multi-AZ peut protéger votre migration contre les défaillances de stockage. La plupart des migrations sont transitoires et ne sont pas destinées à courir pendant de longues périodes. ng a multi-AZ peut améliorer votre disponibilité. Le processus de capture de changement, utilisé lors de la reproduction des changements en cours, recueille les changements dans les journaux de base de données en utilisant l'API native des moteurs de base de données. Chaque moteur a des exigences de configuration spécifiques pour exposer ce flux de changement à un compte utilisateur donné. La plupart des moteurs nécessitent une configuration supplémentaire pour rendre les données de changement consommables de manière significative. gging. Lors de la capture des modifications à partir d'une source RDS d'Amazon, assurez-vous que les sauvegardes sont activées et que la source est configurée pour conserver les journaux de modification pendant une période suffisamment longue. AWS DMS tente de créer le schéma cible pour vous, y compris les tables sous-jacentes et les clés primaires. Parfois, ce n'est pas possible, par exemple, lorsque la cible est Oracle. e Meilleures Pratiques. Pour les besoins de cet article, dans Oracle un utilisateur et un schéma ne sont pas synonymes. La section suivante met en évidence les options communes et importantes à considérer lors de la création d'une tâche. Cette option migre simplement les données de votre système source vers votre cible, créant des tables au besoin. Cette option effectue une charge de données complète tout en saisissant les changements sur la source. Une fois la charge complète terminée, les changements capturés sont appliqués à la cible. Dans certaines situations, il peut être plus efficace de copier les données existantes en utilisant une méthode à l'extérieur de AWS DMS. Lors de la reproduction des modifications de données seulement, vous devez spécifier un moment à partir duquel AWS DMS va commencer à lire les modifications des journaux de changement de base de données. Il est important de garder ces journaux disponibles sur le serveur pour une période de temps afin de s'assurer que AWS D MS a accès à ces modifications. Dans certaines situations, il est utile de reporter le début de la tâche. Ceci est généralement réalisé en maintenant les journaux disponibles pendant 24 heures (ou plus) pendant le processus de migration. Le mode prép de table cible indique à AWS DMS ce qu'il faut faire avec les tables qui existent déjà. Si une table qui est un membre d'une migration n'existe pas encore sur la cible, Amazon DMS créera la table. AWS DMS effectue ces étapes quand il crée une table cible: La base de données source co Le type de données lumn est converti en type de données AWS DMS intermédiaire. Lorsque la table est créée, toutes les données qui existent dans les tables cibles sont laissées telles quelles. Cela peut être utile lors de la consolidation de données de plusieurs systèmes en une seule table. Le type de données AWS DMS est converti en type de données cible. Cette conversion de type de données est effectuée pour les migrations hétérogènes et homogènes. Par exemple, dans certaines situations, il est nécessaire de tripler la taille des colonnes varchar pour tenir compte des caractères multi-octets. Nous recommandons de passer par la documentation AWS DMS sur les types de données source et cible pour voir si tous les types de données que vous utilisez sont supportés. Si les types de données résultantes ne sont pas à votre goût lorsque vous utilisez AWS DMS pour créer vos objets, vous pouvez pré-créer ces objets sur la base de données cible. Les objets de grande taille (LOBs) nécessitent plus de traitement et de ressources que les objets standard. Mode OB. AWS DMS ne prend aucune information concernant la taille des données LOB. Les LOB sont migrés en entier, en morceaux successifs, dont la taille est déterminée par la taille du morceau de LOB. Une taille de morceaux de LOB importante nécessite plus de mémoire et de traitement. La taille du morceau de LOB doit être définie pour permettre à AWS DMS de récupérer la majorité des LOB dans le moins de morceaux possible. Par exemple, si vous avez une table contenant trois LOB, et que vous déplacez des données 1000 lignes à la fois, une taille de morceaux de LOB de 32 k nécessitera 96 000 k de mémoire pour le processus. En utilisant le mode LOB limité est presque toujours plus efficace et plus rapide que le mode LOB complet. Les colonnes LOB sont transférées seulement si la table source a une clé primaire ou un index unique sur la table cible. Si vous avez une table dans laquelle la plupart des LOB sont petits, avec quelques valeurs aberrantes, il peut être une bonne idée de les déplacer dans leur propre table. Le processus a été conçu de cette façon pour accommoder les données source des méthodes. Les moteurs de base utilisent pour gérer les LOBs. La ligne contenant sur la cible est créée sans les données LOB. Le tableau est mis à jour avec les données L OB. Il existe plusieurs options pour surveiller vos tâches à l'aide de la console AWS DMS. Trouvez les entrées appropriées dans les journaux en recherchant les lignes qui commencent par ce qui suit. Vous pouvez utiliser grep (sur les éditeurs de texte basés sur UNIX) ou rechercher (pour les éditeurs basés sur Windows) pour trouver exactement ce que vous cherchez. Vous pouvez trouver des métriques d'hôte sur votre onglet de surveillance des instances de réplication. Ici, y ou peut contrôler si votre instance de réplication est dimensionnée de manière appropriée.Les mesures des tâches de réplication pour les tâches de réplication, y compris les changements entrants et engagés, et la latence entre l'hôte de réplication et les bases de données source/cible peuvent être trouvées. Des mesures de table individuelles peuvent être trouvées sous l'onglet statistiques de tableau pour chaque tâche. Ces mesures comprennent: le nombre de lignes chargées pendant la charge complète. Le nombre d'inserts, de mises à jour et de suppressions depuis le début de la tâche. Nous avons été en mesure de migrer un téraoctet de données en environ 12–13 heures. Nos tests ont été effectués à l'aide de bases de données sources fonctionnant sur EC2, et en Amazon RDS avec des bases de données cibles dans RDS. La performance de votre migration sera limitée par un ou plusieurs goulets d'étranglement vous Au cours de la migration, essayez de supprimer tous les processus qui seraient en compétition pour les ressources d'écriture sur votre base de données cible. Cela inclut désactiver les déclencheurs inutiles, la validation, les index secondaires, etc. Lors de la migration vers une base de données RDS, il est une bonne idée de désactiver les sauvegardes et Multi-AZ sur la cible jusqu'à ce que vous soyez prêt à couper. Si vous avez des jeux de tables qui ne participent pas à des transactions communes, il peut être possible de diviser votre migration en plusieurs tâches. La cohérence transactionnelle est maintenue au sein d'une tâche. Les tâches dans des tâches distinctes ne participent pas à des transactions communes. Attention à ne pas trop insister sur le système source. tâches. Faites attention aux paramètres de LOB. Dans la mesure du possible, utilisez le mode LOB limité. Un examen des Services Web Amazon – AWS Database Migration Service Best Practices peut vous aider à déterminer s'il s'agit d'une bonne option. Si vous avez une table qui se compose de quelques grands LOBs et principalement de plus petits L OBs, envisagez de séparer la table. Vous pouvez ensuite utiliser une tâche en mode LOB limité pour migrer la table contenant de petits LOBs, et une tâche pour migrer la table contenant de grands Lobs. Par défaut, les processus AWS DMS les changements dans un mode transactionnel. Les LOB sont migrés en utilisant un processus en deux étapes : d'abord, la ligne contenant est créée sans la LOB, puis la ligne est mise à jour avec les données L OB. Les transactions d'application optimisées par lots et les applique en lots à des fins d'efficacité. L'utilisation de l'application optimisée par lots va presque certainement violer les contraintes d'intégrité référentes. Vous devez les désactiver pendant le processus de migration et les activer dans le cadre du processus de coupe. Si vous préférez ne pas ajouter de charge à votre source, envisagez d'effectuer la migration à partir d'une copie de lecture de votre système source. Amazon Web Services – AWS Database Migration Service Meilleures Pratiques. Voulez-vous déplacer vos donnéesb A partir d'un moteur commercial à une alternative open source? Peut-être voulez-vous déplacer certaines de vos données de RDS dans Amazon Redshift. Ces scénarios et d'autres similaires peuvent être considérés -Les migrations de base de données -Un projet de migration typique comprend les étapes suivantes. Au minimum, vous voulez faire ce qui suit : Effectuez une évaluation. Découvrez ce que vous devez changer dans votre environnement pour faire une migration réussie. Mes types de données sont-ils compatibles avec ceux couverts par AWS DMS? Mon système source a-t-il la capacité nécessaire? C'est une bonne idée d'utiliser une petite migration de test composée d'un couple de tables pour vérifier que vous avez bien configuré les choses. Testez la migration avec n'importe quel objet que vous soupçonnez pourrait être difficile. Ceux-ci peuvent inclure des objets LOB, des conversions de jeux de caractères, des types de données complexes, etc. Vous devez déterminer exactement comment vous comptez migrer votre application. Une fois que vous avez terminé votre prototypage, c'est une bonne idée de tester une migration complète. Est-ce que tous les objets sont comptabilisés? Est-ce que la migration s'inscrit dans les délais prévus? Y a-t-il des erreurs ou des avertissements dans les fichiers journaux qui sont une préoccupation? Combien de chargement le processus de migration ajoutera-t-il à ma base de données source? Au cours d'une migration, AWS DMS effectue une analyse complète de la table source pour chaque table traitée en parallèle. La taille, l'emplacement et la conservation des fichiers journaux peuvent avoir un impact sur la charge. Si vos tâches contiennent un composant de Capture de données de changement (CDC), la taille et l'emplacement du fichier journal peuvent avoir un impact significatif sur la charge. La quantité totale de données migrées, la quantité et la taille des données LOB, la taille des plus grandes tables, le nombre total d'objets migrés, les index secondaires créés sur la cible avant la migration, les ressources ava Vous pouvez utiliser l'outil gratuit de conversion AWS Schema (AWS SCT) pour convertir un schéma entier d'un moteur de base de données à un autre. Tous les moteurs de base de données pris en charge par AWS DMS ont des outils natifs que vous pouvez utiliser pour exporter et importer votre schéma. L'AWS SCT peut être utilisé avec AWS DMS pour faciliter la migration de votre système entier. Le DMS AWS est destiné à être utilisé avec l'une de ces méthodes pour effectuer une migration complète de votre base de données. Il y a deux principales raisons pour lesquelles nous voyons des personnes changer de moteur. Le client veut utiliser un cadre ou une plate-forme moderne pour son portefeuille d'applications. Ces plates-formes ne sont disponibles que sur des moteurs de base de données plus modernes. Amazon a essayé de rendre AWS DMS compatible avec autant de versions de base de données prises en charge que possible. Certaines versions de base de données ne supportent pas les fonctionnalités nécessaires requises par AWS DMS, en particulier en ce qui concerne la capture et l'application de changement. Actuellement, pour migrer complètement à partir d'un moteur de base de données non pris en charge, vous devez d'abord mettre votre base de données à niveau vers un moteur pris en charge. apabilités de DMS. La plupart des bases de données offrent une méthode native pour migrer entre serveurs ou plateformes. Si vous effectuez une migration ahomogène, l'une des méthodes suivantes pourrait fonctionner pour vous. Amazon Web Services – AWS Database Migration Service Meilleures Pratiques. Utiliser une simple sauvegarde et restaurer ou exporter/importer est le moyen le plus efficace pour migrer vos données. Si vous envisagez une migration homogène, vous devriez d'abord évaluer si une option native appropriée existe. Lorsque vous migrez entre différentes saveurs de MySQL ou d'Amazon Aurora, créer et promouvoir une réplique de lecture est probablement votre meilleure option. Voir Importation et exportation de données d'une instance MySQL DB. Si vous pouvez configurer avec succès une réplique de votre base de données primaire dans votre environnement cible en utilisant des outils natifs plus facilement que vous ne pouvez avec DMS, vous devriez envisager d'utiliser cette méthode native pour migrer votre système . Quelques exemples incluent: Myroids, Postgres, Oracle, et SQL Server. Cela dépend de votre environnement, la distribution des données, et la façon dont votre système source est occupé. La meilleure façon de déterminer si votre système particulier est un candidat pour DMS est de le tester. Commencez lentement, pour obtenir la configuration travaillée, ajoutez quelques objets complexes, et finalement essayer une charge complète comme un test. Au cours d'un week-end (environ 33 heures) nous avons pu migrer cinq téraoctets de dat relativement uniformément répartis a. Il s'agissait de quatre grandes tables (250 Go), d'un énorme tableau (1 To), de 1 000 tables de petite à moyenne taille, de trois tables contenant des LOB variant entre 25 Go et 75 Go, et de 10 000 tables de très petite taille. Le DMS peut être utilisé pour réduire au minimum les pannes liées aux bases de données lorsqu'il s'agit de déplacer une base de données de l'extérieur d'un VPC vers un PC V. Amazon Web Services – AWS Database Migration Service Best Practices. Ce document décrit les meilleures pratiques pour utiliser AWS DMS pour migrer les données d'une base de données source vers une base de données cible. Les solutions suivantes sont les stratégies de base pour migrer vers un VPC. AWS DMS aide à migrer les charges de travail des bases de données vers AWS ou changer les moteurs de base de données tout en minimisant les temps d'arrêt associés. La plupart des méthodes actuelles pour migrer les bases de données vers le cloud ou les moteurs de commutation nécessitent une panne prolongée. Les personnes et organisations suivantes ont contribué à ce document. Nous sommes heureux de vous avoir en tant que membre de notre équipe. les commentaires ci-dessous ou envoyez-nous un courriel à jennifer.smith@mailonline.co.uk.
